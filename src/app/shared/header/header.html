<!-- header.component.html -->
<header class="bg-white shadow-lg fixed top-0 left-0 w-full z-50">
  <div class="w-full px-3 sm:px-4 lg:px-6">
    <nav class="flex justify-between items-center py-2.5 sm:py-2 min-h-[3.5rem] sm:min-h-[4rem]">
      <!-- Logo (far left) -->
      <div class="flex-shrink-0 order-1 min-w-0">
        <a routerLink="/" class="flex items-center text-decoration-none">
          <img src="assets/img/logo.png" alt="NAPLAN Bridge Logo" class="w-auto mr-1.5 sm:mr-3 h-9 sm:h-12 lg:h-14"
            onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
          <div class="text-center" style="display: none;">
            <span class="text-base sm:text-xl font-bold text-primary-500 leading-none whitespace-nowrap">NAPLAN</span>
            <span class="text-xs sm:text-sm text-gray-600 font-medium -mt-1 block whitespace-nowrap">Bridge</span>
          </div>
        </a>
      </div>

      <!-- Navigation (center) -->
      <ul class="hidden md:flex xl:space-x-6 lg:space-x-4 md:space-x-3 list-none order-2 items-center">
        @for (item of navigationItems; track item.id) {
          @if (item.label === 'Subjects') {
            <li class="relative group">
              <button
                (click)="navigateToCourses()"
                [class.text-primary-500]="router.url.includes('/courses')"
                [class.bg-blue-50]="router.url.includes('/courses')"
                [class.font-semibold]="router.url.includes('/courses')"
                class="nav-button text-gray-700 hover:text-primary-500 hover:bg-blue-50 px-2 xl:px-3 py-2 rounded-lg font-medium transition-all duration-300 flex items-center gap-1 whitespace-nowrap cursor-pointer">
                {{ item.label }}
              </button>
              <ul class="absolute left-0 top-full mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                <li><a (click)="navigateToCoursesWithFilter('mathematics'); closeMobileMenuIfOpen()" class="block px-4 py-2 hover:bg-blue-50 hover:text-primary-500 cursor-pointer flex items-center gap-2 whitespace-nowrap text-sm">
                  <i class="fas fa-calculator text-blue-600"></i>
                  Mathematics
                </a></li>
                <li><a (click)="navigateToCoursesWithFilter('reading'); closeMobileMenuIfOpen()" class="block px-4 py-2 hover:bg-blue-50 hover:text-primary-500 cursor-pointer flex items-center gap-2 whitespace-nowrap text-sm">
                  <i class="fas fa-book-open text-green-600"></i>
                  Reading
                </a></li>
                <li><a (click)="navigateToCoursesWithFilter('writing'); closeMobileMenuIfOpen()" class="block px-4 py-2 hover:bg-blue-50 hover:text-primary-500 cursor-pointer flex items-center gap-2 whitespace-nowrap text-sm">
                  <i class="fas fa-pen text-purple-600"></i>
                  Writing
                </a></li>
                <li><a (click)="navigateToCoursesWithFilter('language'); closeMobileMenuIfOpen()" class="block px-4 py-2 hover:bg-blue-50 hover:text-primary-500 cursor-pointer flex items-center gap-2 whitespace-nowrap text-sm">
                  <i class="fas fa-language text-orange-600"></i>
                  Language Conventions
                </a></li>
                <li><a (click)="closeMobileMenuIfOpen()" routerLink="/courses" class="block px-4 py-2 hover:bg-blue-50 hover:text-primary-500 border-t border-gray-100 mt-1 pt-3 flex items-center gap-2 whitespace-nowrap text-sm">
                  <i class="fas fa-list text-gray-600"></i>
                  View All Subjects
                </a></li>
              </ul>
            </li>
          } @else if (item.isAboutSection) {
            <li>
              <a [class.text-primary-500]="router.url.includes('/about')"
                 [class.bg-blue-50]="router.url.includes('/about')"
                 [class.font-semibold]="router.url.includes('/about')"
                 class="nav-button px-2 xl:px-3 py-2 rounded-lg font-medium transition-all duration-300 no-underline hover:text-primary-500 hover:bg-blue-50 cursor-pointer whitespace-nowrap"
                 (click)="navigateToAboutSection()">
                {{ item.label }}
              </a>
            </li>
          } @else {
            <li>
              <a [routerLink]="item.route"
                 routerLinkActive="text-primary-500 bg-blue-50 font-semibold"
                 [routerLinkActiveOptions]="{ exact: true }"
                 class="nav-button px-2 xl:px-3 py-2 rounded-lg font-medium transition-all duration-300 no-underline hover:text-primary-500 hover:bg-blue-50 whitespace-nowrap">
                {{ item.label }}
              </a>
            </li>
          }
        }
      </ul>

      <!-- Login/Logout Button & Mobile Menu Toggle -->
      <div class="flex items-center space-x-2 sm:space-x-3 lg:space-x-4 order-3 min-w-0">
        <!-- Desktop Login/Logout Button -->
        @if (isLoggedIn) {
          <div class="hidden md:flex items-center space-x-2 xl:space-x-3">
            <!-- Cart Icon - Hidden for Students -->
            @if (userRole !== 'Student') {
              <button
                (click)="navigateToCart()"
                class="relative p-1.5 xl:p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 flex-shrink-0">
                <svg class="w-5 h-5 xl:w-6 xl:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5H21M7 13v6a2 2 0 002 2h6a2 2 0 002-2v-6"></path>
                </svg>
                @if (cartItemCount > 0) {
                  <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 xl:w-5 xl:h-5 flex items-center justify-center text-[10px] xl:text-xs">
                    {{ cartItemCount }}
                  </span>
                }
              </button>
            }

            <!-- Notifications Icon -->
            <div class="relative" clickOutside (clickOutside)="closeNotificationsDropdown()">
              <button
                (click)="toggleNotificationsDropdown()"
                class="relative p-1.5 xl:p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 flex-shrink-0">
                <svg class="w-5 h-5 xl:w-6 xl:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                </svg>
                @if (unreadNotificationsCount > 0) {
                  <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 xl:w-5 xl:h-5 flex items-center justify-center text-[10px] xl:text-xs">
                    {{ unreadNotificationsCount }}
                  </span>
                }
              </button>

              <!-- Notifications Dropdown -->
              @if (showNotificationsDropdown) {
                <div class="absolute right-0 top-full mt-2 w-72 sm:w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50">
                  <div class="p-3 sm:p-4 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                      <h3 class="font-semibold text-gray-900 text-sm sm:text-base">Notifications</h3>
                      <button
                        (click)="navigateToNotifications(); closeNotificationsDropdown()"
                        class="text-blue-600 hover:text-blue-800 text-xs sm:text-sm font-medium whitespace-nowrap">
                        View All
                      </button>
                    </div>
                  </div>
                  <div class="max-h-80 sm:max-h-96 overflow-y-auto">
                    <!-- Recent Notifications Preview -->
                    @if (recentNotifications.length > 0) {
                      <div class="divide-y divide-gray-100">
                        @for (notification of recentNotifications; track notification.id) {
                          <div
                            class="p-3 sm:p-4 hover:bg-gray-50 cursor-pointer transition-colors duration-200"
                            (click)="onDropdownNotificationClick(notification)">
                            <div class="flex items-start gap-2 sm:gap-3">
                              <!-- Notification Icon -->
                              <div class="flex-shrink-0">
                                <div class="w-6 h-6 sm:w-8 sm:h-8 rounded-full flex items-center justify-center"
                                     [ngClass]="notification.type === 'course' ? 'bg-blue-100' :
                                                notification.type === 'success' ? 'bg-green-100' :
                                                notification.type === 'warning' ? 'bg-yellow-100' :
                                                notification.type === 'error' ? 'bg-red-100' :
                                                notification.type === 'info' ? 'bg-blue-100' : 'bg-gray-100'">
                                  <i [class]="getNotificationIcon(notification.type) + ' text-xs sm:text-sm ' + getNotificationColor(notification.type)"></i>
                                </div>
                              </div>

                              <!-- Notification Content -->
                              <div class="flex-1 min-w-0 notification-content">
                                <div class="flex items-start justify-between">
                                  <div class="flex-1 min-w-0">
                                    <p class="text-xs sm:text-sm font-medium text-gray-900 line-clamp-1">
                                      {{ notification.title }}
                                      @if (!notification.isRead) {
                                        <span class="inline-block w-1.5 h-1.5 sm:w-2 sm:h-2 bg-blue-500 rounded-full ml-1"></span>
                                      }
                                    </p>
                                    <p class="text-xs text-gray-600 line-clamp-2 mt-1">{{ notification.message }}</p>
                                    <p class="text-xs text-gray-400 mt-1">{{ getRelativeTime(notification.sentAt) }}</p>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        }
                      </div>

                      <!-- Show more link -->
                      <div class="p-3 sm:p-4 border-t border-gray-200 bg-gray-50">
                        <button
                          (click)="navigateToNotifications(); closeNotificationsDropdown()"
                          class="w-full text-center text-blue-600 hover:text-blue-800 text-xs sm:text-sm font-medium py-2 rounded-lg hover:bg-blue-50 transition-colors duration-200">
                          View All {{ unreadNotificationsCount > 0 ? '(' + unreadNotificationsCount + ' unread)' : '' }}
                        </button>
                      </div>
                    } @else {
                      <!-- Empty state -->
                      <div class="p-4 sm:p-6 text-center text-gray-500">
                        <div class="w-10 h-10 sm:w-12 sm:h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3">
                          <i class="fas fa-bell-slash text-gray-400 text-sm sm:text-base"></i>
                        </div>
                        <p class="text-xs sm:text-sm">No notifications yet</p>
                        <p class="text-xs text-gray-400 mt-1">You'll see your notifications here</p>
                      </div>
                    }
                  </div>
                </div>
              }
            </div>

            @if (userName) {
              <div class="relative group">
                <button
                  (click)="navigateToProfile()"
                  class="user-welcome hidden lg:block text-gray-600 font-medium whitespace-nowrap truncate hover:text-primary-500 transition-colors duration-200 cursor-pointer bg-transparent border-none px-2 py-2 rounded hover:bg-blue-50">
                  <i class="fas fa-user-circle me-1 text-lg"></i>{{ userName }}
                </button>

                <!-- User Profile Dropdown Menu -->
                <ul class="absolute left-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                  <li><a (click)="navigateToProfile()" class="block px-4 py-2 hover:bg-blue-50 hover:text-primary-500 cursor-pointer flex items-center gap-2 text-sm">
                    <i class="fas fa-user text-blue-600"></i>
                    View Profile
                  </a></li>
                  <li><a routerLink="/profile/edit" class="block px-4 py-2 hover:bg-blue-50 hover:text-primary-500 cursor-pointer flex items-center gap-2 text-sm">
                    <i class="fas fa-edit text-green-600"></i>
                    Edit Profile
                  </a></li>
                  <li><a (click)="navigateToNotifications()" class="block px-4 py-2 hover:bg-blue-50 hover:text-primary-500 cursor-pointer flex items-center gap-2 text-sm border-t border-gray-100 mt-1 pt-2">
                    <i class="fas fa-cog text-gray-600"></i>
                    Settings
                  </a></li>
                </ul>
              </div>
            }

            <!-- Role-based dashboard buttons -->
            @if (userRole === 'Admin') {
              <button
                routerLink="/admin/users"
                class="hidden md:flex border border-primary-500 text-primary-500 hover:bg-primary-50 px-2 md:px-3 py-1.5 xl:px-4 xl:py-2 rounded-lg font-semibold transition-all duration-200 text-sm xl:text-base items-center gap-2"
                title="Admin Panel">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                <span class="hidden xl:inline">Admin Panel</span>
              </button>
            }
            @if (userRole === 'Teacher') {
              <button
                (click)="navigateToTeacherDashboard()"
                class="hidden md:flex border border-primary-500 text-primary-500 hover:bg-primary-50 px-2 md:px-3 py-1.5 xl:px-4 xl:py-2 rounded-lg font-semibold transition-all duration-200 text-sm xl:text-base items-center gap-2"
                title="Teacher Panel">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342M6.75 15a.75.75 0 100-1.5.75.75 0 000 1.5zm0 0v-3.675A55.378 55.378 0 0112 8.443m-7.007 11.55A5.981 5.981 0 006.75 15.75v-1.5" />
                </svg>
                <span class="hidden xl:inline">Teacher Panel</span>
              </button>
            }
            @if (userRole === 'Parent') {
              <button
                routerLink="/parent/dashboard"
                class="role-button hidden md:flex border border-primary-500 text-primary-500 hover:bg-primary-50 px-2 md:px-3 py-1.5 xl:px-4 xl:py-2 rounded-lg font-semibold transition-all duration-200 items-center gap-2"
                title="My Children">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
                </svg>
                <span class="hidden xl:inline">My Children</span>
              </button>
            }
            @if (userRole === 'Student') {
              <button
                routerLink="/student/dashboard"
                class="hidden md:flex border border-primary-500 text-primary-500 hover:bg-primary-50 px-2 md:px-3 py-1.5 xl:px-4 xl:py-2 rounded-lg font-semibold transition-all duration-200 text-sm xl:text-base items-center gap-2"
                title="My Dashboard">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" />
                </svg>
                <span class="hidden xl:inline">My Dashboard</span>
              </button>
            }

            <button
              (click)="handleLogout()"
              class="action-button bg-red-500 hover:bg-red-600 text-white px-3 py-1.5 xl:px-6 xl:py-2 rounded-lg font-semibold transition-colors duration-300 whitespace-nowrap">
              Logout
            </button>
          </div>
        } @else {
          @if (isLoginPage) {
            <a routerLink="/auth/register" class="action-button hidden md:block bg-primary-500 hover:bg-primary-600 text-white px-4 py-1.5 xl:px-6 xl:py-2 rounded-lg font-semibold whitespace-nowrap">
              Register
            </a>
          } @else {
            <a routerLink="/auth/register" class="action-button hidden md:block bg-primary-500 hover:bg-primary-600 text-white px-3 py-1.5 xl:px-4 xl:py-2 rounded-lg font-semibold whitespace-nowrap">
              Register
            </a>
            <a routerLink="/auth/login" class="action-button hidden md:block bg-primary-500 hover:bg-primary-600 text-white px-4 py-1.5 xl:px-6 xl:py-2 rounded-lg font-semibold whitespace-nowrap">
              Login
            </a>
          }
        }

        <!-- Mobile Menu Toggle -->
        <button
          class="md:hidden flex flex-col justify-center items-center space-y-1 p-1.5 flex-shrink-0 w-9 h-9 rounded-lg hover:bg-gray-100 transition-colors"
          (click)="toggleMobileMenu()"
          [class.active]="isMobileMenuOpen"
          aria-label="Toggle navigation">
          <span class="block w-5 h-0.5 bg-gray-700 transition-transform duration-300"
                [class.rotate-45]="isMobileMenuOpen"
                [class.translate-y-1.5]="isMobileMenuOpen"></span>
          <span class="block w-5 h-0.5 bg-gray-700 transition-opacity duration-300"
                [class.opacity-0]="isMobileMenuOpen"></span>
          <span class="block w-5 h-0.5 bg-gray-700 transition-transform duration-300"
                [class.-rotate-45]="isMobileMenuOpen"
                [class.-translate-y-1.5]="isMobileMenuOpen"></span>
        </button>
      </div>
    </nav>

    <!-- Mobile Navigation -->
    @if (isMobileMenuOpen) {
      <!-- Backdrop/Overlay -->
      <div
        class="fixed inset-0 bg-black/20 md:hidden z-40"
        (click)="toggleMobileMenu()"
        aria-hidden="true">
      </div>

      <!-- Menu Content -->
      <div class="md:hidden lg:hidden bg-white border-t border-gray-200 py-3 max-h-[calc(100vh-4rem)] overflow-y-auto relative z-50">
        <ul class="space-y-1.5 list-none px-3">
          @for (item of navigationItems; track item.id) {
            @if (item.label === 'Subjects') {
              <!-- Subjects without subcategories for Mobile -->
              <li>
                <button
                  (click)="navigateToCourses(); toggleMobileMenu()"
                  class="w-full text-left block text-gray-700 hover:text-primary-500 hover:bg-blue-50 px-3 py-2.5 rounded-lg font-medium transition-all duration-200 text-sm">
                  {{ item.label }}
                </button>
              </li>
            } @else {
              <li>
                <a
                  [routerLink]="item.route"
                  routerLinkActive="text-primary-500 bg-blue-50 font-semibold"
                  [routerLinkActiveOptions]="{ exact: item.route === '/' }"
                  class="block text-gray-700 hover:text-primary-500 hover:bg-blue-50 px-3 py-2.5 rounded-lg font-medium transition-all duration-200 no-underline text-sm"
                  (click)="toggleMobileMenu()">
                  {{ item.label }}
                </a>
              </li>
            }
          }
          <li class="pt-1 border-t border-gray-100 mt-1.5">
            @if (isLoggedIn) {
              <div class="space-y-2 pt-2">
                @if (userName) {
                  <div class="text-center text-gray-700 font-semibold px-3 py-1.5 text-sm bg-gray-50 rounded-lg">
                    Welcome, {{ userName }}
                  </div>
                }

                <!-- Mobile Cart and Notifications -->
                <div class="flex justify-center gap-3 py-2">
                  @if (userRole !== 'Student') {
                    <button
                      (click)="navigateToCart(); toggleMobileMenu()"
                      class="relative p-2.5 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 border border-gray-200">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5H21M7 13v6a2 2 0 002 2h6a2 2 0 002-2v-6"></path>
                      </svg>
                      @if (cartItemCount > 0) {
                        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center text-[10px]">
                          {{ cartItemCount }}
                        </span>
                      }
                    </button>
                  }

                  <button
                    (click)="navigateToNotifications(); toggleMobileMenu()"
                    class="relative p-2.5 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 border border-gray-200">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                    </svg>
                    @if (unreadNotificationsCount > 0) {
                      <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center text-[10px]">
                        {{ unreadNotificationsCount }}
                      </span>
                    }
                  </button>
                </div>

                <!-- Mobile Role-based buttons -->
                <div class="space-y-2">
                  @if (userRole === 'Admin') {
                    <a
                      routerLink="/admin/users"
                      class="block w-full text-center border border-primary-500 text-primary-500 hover:bg-primary-50 px-3 py-2.5 rounded-lg font-semibold transition-all duration-200 text-sm"
                      (click)="toggleMobileMenu()">
                      <i class="fas fa-cog mr-1"></i> Admin Panel
                    </a>
                  }

                  <!-- Profile Edit Link (Mobile) -->
                  <a
                    routerLink="/profile/edit"
                    class="block w-full text-center border border-blue-500 text-blue-600 hover:bg-blue-50 px-3 py-2.5 rounded-lg font-semibold transition-all duration-200 text-sm"
                    (click)="toggleMobileMenu()">
                    <i class="fas fa-edit mr-1"></i> Edit Profile
                  </a>
                  @if (userRole === 'Teacher') {
                    <button
                      (click)="navigateToTeacherDashboard(); toggleMobileMenu()"
                      class="block w-full text-center border border-primary-500 text-primary-500 hover:bg-primary-50 px-3 py-2.5 rounded-lg font-semibold transition-all duration-200 text-sm">
                      <i class="fas fa-chalkboard-teacher mr-1"></i> Teacher Panel
                    </button>
                  }
                  @if (userRole === 'Parent') {
                    <a
                      routerLink="/parent/dashboard"
                      class="block w-full text-center border border-primary-500 text-primary-500 hover:bg-primary-50 px-3 py-2.5 rounded-lg font-semibold transition-all duration-200 text-sm"
                      (click)="toggleMobileMenu()">
                      <i class="fas fa-users mr-1"></i> My Children
                    </a>
                  }
                  @if (userRole === 'Student') {
                    <a
                      routerLink="/student/dashboard"
                      class="block w-full text-center border border-primary-500 text-primary-500 hover:bg-primary-50 px-3 py-2.5 rounded-lg font-semibold transition-all duration-200 text-sm"
                      (click)="toggleMobileMenu()">
                      <i class="fas fa-tachometer-alt mr-1"></i> My Dashboard
                    </a>
                  }

                  <button
                    (click)="handleLogout()"
                    class="w-full bg-red-500 hover:bg-red-600 text-white px-3 py-2.5 rounded-lg font-semibold transition-colors duration-200 text-sm">
                    <i class="fas fa-sign-out-alt mr-1"></i> Logout
                  </button>
                </div>
              </div>
            } @else {
              <div class="space-y-2 pt-2">
                <a
                  routerLink="/auth/login"
                  class="block w-full bg-primary-500 hover:bg-primary-600 text-white px-3 py-2.5 rounded-lg font-semibold transition-colors duration-200 text-center text-sm"
                  (click)="toggleMobileMenu()">
                  <i class="fas fa-sign-in-alt mr-1"></i> Login
                </a>
                <a
                  routerLink="/auth/register"
                  class="block w-full border border-primary-500 text-primary-500 hover:bg-primary-50 px-3 py-2.5 rounded-lg font-semibold transition-all duration-200 text-center text-sm"
                  (click)="toggleMobileMenu()">
                  <i class="fas fa-user-plus mr-1"></i> Register
                </a>
              </div>
            }
          </li>
        </ul>
      </div>
    }
  </div>
</header>
