<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50">
  <div class="container mx-auto px-4 py-8 max-w-7xl">

    <!-- Header -->
    <div class="mb-8">
      <div class="flex items-center justify-between mb-4">
        <div>
          <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
            My Subjects
          </h1>
          <p class="text-gray-600 mt-2">Subjects you're currently enrolled in</p>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    @if (loading()) {
      <div class="flex items-center justify-center py-20">
        <div class="text-center">
          <div class="inline-block w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"></div>
          <p class="text-gray-600">Loading your subjects...</p>
        </div>
      </div>
    }

    <!-- Empty State -->
    @else if (enrolledSubjects().length === 0) {
      <div class="bg-white rounded-xl shadow-lg p-12 text-center">
        <div class="max-w-md mx-auto">
          <div class="text-6xl mb-4">üìö</div>
          <h2 class="text-2xl font-bold text-gray-900 mb-4">No Active Subscriptions</h2>
          <p class="text-gray-600">
            You don't have any active subscriptions yet. Please contact your administrator to get started.
          </p>
        </div>
      </div>
    }

    <!-- Subjects Grid -->
    @else {
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        @for (subject of enrolledSubjects(); track subject.subjectId) {
          <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 border-2 border-transparent hover:border-blue-300">

            <!-- Subject Image -->
            <div class="relative h-48 bg-gradient-to-br from-blue-500 to-purple-600 overflow-hidden">
              @if (subject.posterUrl) {
                <img
                  [src]="subject.posterUrl"
                  [alt]="subject.subjectName"
                  class="w-full h-full object-cover">
              } @else {
                <div class="flex items-center justify-center h-full">
                  <span class="text-white text-6xl">üìñ</span>
                </div>
              }

              <!-- Status Badge -->
              <div class="absolute top-4 right-4">
                <span [class]="getStatusColor(subject.isActive)"
                      class="px-3 py-1 rounded-full text-xs font-semibold shadow-lg">
                  {{ subject.isActive ? 'Active' : 'Inactive' }}
                </span>
              </div>
            </div>

            <!-- Subject Details -->
            <div class="p-6">
              <!-- Title & Category -->
              <div class="mb-4">
                <h3 class="text-xl font-bold text-gray-900 mb-1">{{ subject.subjectName }}</h3>
                @if (subject.categoryName) {
                  <p class="text-sm text-gray-500">{{ subject.categoryName }}</p>
                }
              </div>

              <!-- Subscription Info -->
              <div class="space-y-3 mb-6">
                <!-- Days Remaining -->
                @if (subject.daysRemaining !== undefined) {
                  <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600 flex items-center gap-2">
                      <span>‚è∞</span>
                      <span>Time Remaining</span>
                    </span>
                    <span [class]="getDaysRemainingColor(subject.daysRemaining)"
                          class="px-3 py-1 rounded-full text-xs font-semibold">
                      {{ subject.daysRemaining }} days
                    </span>
                  </div>
                }

                <!-- Expiry Date -->
                @if (subject.expiryDate) {
                  <div class="flex items-center justify-between text-sm">
                    <span class="text-gray-600">Expires On</span>
                    <span class="font-medium text-gray-900">{{ formatDate(subject.expiryDate) }}</span>
                  </div>
                }

                <!-- Accessible Terms -->
                @if (subject.accessibleTerms && subject.accessibleTerms.length > 0) {
                  <div class="flex items-center justify-between text-sm">
                    <span class="text-gray-600">Access</span>
                    <span class="font-medium text-blue-600">
                      {{ getAccessibleTermsText(subject.accessibleTerms) }}
                    </span>
                  </div>
                }

                <!-- Current Term -->
                @if (subject.currentTermNumber) {
                  <div class="flex items-center justify-between text-sm">
                    <span class="text-gray-600">Current Term</span>
                    <span class="font-medium text-gray-900">Term {{ subject.currentTermNumber }}</span>
                  </div>
                }
              </div>

              <!-- Action Buttons -->
              <div class="flex gap-3">
                <button
                  (click)="viewSubjectLessons(subject)"
                  [disabled]="!subject.isActive"
                  [class.opacity-50]="!subject.isActive"
                  [class.cursor-not-allowed]="!subject.isActive"
                  class="flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg transition-all font-semibold flex items-center justify-center gap-2">
                  <span>üìö</span>
                  <span>View Lessons</span>
                </button>
              </div>

              <!-- Warning for Expiring Soon -->
              @if (subject.isActive && subject.daysRemaining && subject.daysRemaining <= 7) {
                <div class="mt-4 p-3 bg-red-50 border border-red-200 rounded-lg">
                  <p class="text-xs text-red-700 font-medium">
                    ‚ö†Ô∏è Your subscription expires in {{ subject.daysRemaining }} day{{ subject.daysRemaining > 1 ? 's' : '' }}!
                  </p>
                </div>
              }
            </div>
          </div>
        }
      </div>


    }
  </div>
</div>
