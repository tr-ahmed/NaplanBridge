<!-- Add Student - Enhanced Version --><div class="min-h-screen flex items-center justify-center bg-gradient-to-b from-white to-gray-100 px-4 pt-20">

<div class="min-h-screen bg-gray-50 py-8">  <div class="bg-white p-8 rounded-[10px] shadow-2xl w-full max-w-3xl border border-dashed border-blue-500">

  <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- Logo -->

    <!-- Header -->    <div class="flex justify-center">

    <div class="mb-8 text-center">      <img src="assets/img/logo.png"

      <h1 class="text-3xl font-bold text-gray-900">Add New Student</h1>           alt="Logo"

      <p class="mt-2 text-sm text-gray-600">Register your child and link them to your account</p>           onerror="this.style.display='none'"

    </div>           class="w-24 h-24 rounded-full" />

    </div>

    <!-- Form Card -->

    <div class="bg-white rounded-lg shadow-md p-8">    <!-- Title -->

      <form [formGroup]="addStudentForm" (ngSubmit)="onSubmit()" class="space-y-6" novalidate>    <h2 class="text-xl font-bold text-blue-900 text-center mb-6">Add New Student</h2>



        <!-- Student Name -->    <form [formGroup]="addStudentForm" (ngSubmit)="onSubmit()" class="space-y-4" novalidate>

        <div>      <!-- userName -->

          <label class="block text-sm font-medium text-gray-700 mb-2">      <div>

            Student Username <span class="text-red-500">*</span>        <label class="block text-sm font-medium text-blue-900 mb-1">Username</label>

          </label>        <input

          <input          type="text"

            type="text"          formControlName="userName"

            formControlName="userName"          [class]="addStudentForm.get('userName')?.invalid && addStudentForm.get('userName')?.touched ?

            class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"            'w-full px-3 py-2 border border-red-500 rounded focus:outline-none focus:ring-2 focus:ring-red-200' :

            [class.border-red-500]="hasError('userName', 'required')"            'w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-200'"

            [class.border-gray-300]="!hasError('userName', 'required')"          placeholder="Enter username"

            placeholder="e.g., ahmed_hassan"        />

          />        @if (addStudentForm.get('userName')?.invalid && addStudentForm.get('userName')?.touched) {

          @if (hasError('userName', 'required')) {          <small class="text-red-500 text-xs mt-1">Username is required.</small>

            <p class="mt-1 text-sm text-red-500">{{ getErrorMessage('userName') }}</p>        }

          }      </div>

          @if (hasError('userName', 'minlength')) {

            <p class="mt-1 text-sm text-red-500">{{ getErrorMessage('userName') }}</p>      <!-- password -->

          }      <div>

        </div>        <label class="block text-sm font-medium text-blue-900 mb-1">Password</label>

        <input

        <!-- Email (Optional) -->          type="password"

        <div>          formControlName="password"

          <label class="block text-sm font-medium text-gray-700 mb-2">          [class]="addStudentForm.get('password')?.invalid && addStudentForm.get('password')?.touched ?

            Email Address <span class="text-gray-400 text-xs">(Optional)</span>            'w-full px-3 py-2 border border-red-500 rounded focus:outline-none focus:ring-2 focus:ring-red-200' :

          </label>            'w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-200'"

          <input          placeholder="Enter password"

            type="email"        />

            formControlName="email"        @if (addStudentForm.get('password')?.invalid && addStudentForm.get('password')?.touched) {

            class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"          <small class="text-red-500 text-xs mt-1">Password is required (min 6 chars).</small>

            [class.border-red-500]="hasError('email', 'email')"        }

            [class.border-gray-300]="!hasError('email', 'email')"      </div>

            placeholder="student@example.com"

          />      <!-- year -->

          @if (hasError('email', 'email')) {      <div>

            <p class="mt-1 text-sm text-red-500">{{ getErrorMessage('email') }}</p>        <label class="block text-sm font-medium text-blue-900 mb-1">Year</label>

          }        <input

        </div>          type="number"

          formControlName="year"

        <!-- Password & Confirm Password Grid -->          [class]="addStudentForm.get('year')?.invalid && addStudentForm.get('year')?.touched ?

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">            'w-full px-3 py-2 border border-red-500 rounded focus:outline-none focus:ring-2 focus:ring-red-200' :

          <!-- Password -->            'w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-200'"

          <div>          placeholder="Enter year"

            <label class="block text-sm font-medium text-gray-700 mb-2">        />

              Password <span class="text-red-500">*</span>        @if (addStudentForm.get('year')?.invalid && addStudentForm.get('year')?.touched) {

            </label>          <small class="text-red-500 text-xs mt-1">Year is required.</small>

            <input        }

              type="password"      </div>

              formControlName="password"

              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"      <!-- age -->

              [class.border-red-500]="hasError('password', 'required') || hasError('password', 'minlength')"      <div>

              [class.border-gray-300]="!hasError('password', 'required') && !hasError('password', 'minlength')"        <label class="block text-sm font-medium text-blue-900 mb-1">Age</label>

              placeholder="Min 6 characters"        <input

            />          type="number"

            @if (hasError('password', 'required') || hasError('password', 'minlength')) {          formControlName="age"

              <p class="mt-1 text-sm text-red-500">{{ getErrorMessage('password') }}</p>          [class]="addStudentForm.get('age')?.invalid && addStudentForm.get('age')?.touched ?

            }            'w-full px-3 py-2 border border-red-500 rounded focus:outline-none focus:ring-2 focus:ring-red-200' :

          </div>            'w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-200'"

          placeholder="Enter age"

          <!-- Confirm Password -->        />

          <div>        @if (addStudentForm.get('age')?.invalid && addStudentForm.get('age')?.touched) {

            <label class="block text-sm font-medium text-gray-700 mb-2">          <small class="text-red-500 text-xs mt-1">Age is required and must be positive.</small>

              Confirm Password <span class="text-red-500">*</span>        }

            </label>      </div>

            <input

              type="password"      <!-- Error & Success Messages -->

              formControlName="confirmPassword"      @if (error) {

              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"        <div class="mb-4 text-red-600 text-center">{{ error }}</div>

              [class.border-red-500]="addStudentForm.hasError('passwordMismatch') && addStudentForm.get('confirmPassword')?.touched"      }

              [class.border-gray-300]="!addStudentForm.hasError('passwordMismatch') || !addStudentForm.get('confirmPassword')?.touched"      @if (success) {

              placeholder="Repeat password"        <div class="mb-4 text-green-600 text-center">Student added successfully!</div>

            />      }

            @if (addStudentForm.hasError('passwordMismatch') && addStudentForm.get('confirmPassword')?.touched) {

              <p class="mt-1 text-sm text-red-500">Passwords do not match</p>      <!-- Submit Button -->

            }      <div class="text-center mt-6">

          </div>        <button

        </div>          type="submit"

          [disabled]="loading || addStudentForm.invalid"

        <!-- Age & Academic Year Grid -->          [class]="loading || addStudentForm.invalid ?

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">            'bg-gray-400 text-white py-2 px-4 rounded-lg font-semibold w-full cursor-not-allowed' :

          <!-- Age -->            'bg-primary-500 hover:bg-primary-600 text-white py-2 px-4 rounded-lg font-semibold w-full'"

          <div>        >

            <label class="block text-sm font-medium text-gray-700 mb-2">          @if (loading) { Adding student... } @else { Add Student }

              Age <span class="text-red-500">*</span>        </button>

            </label>      </div>

            <input    </form>

              type="number"  </div>

              formControlName="age"</div>

              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"
              [class.border-red-500]="hasError('age', 'required')"
              [class.border-gray-300]="!hasError('age', 'required')"
              placeholder="e.g., 12"
              min="5"
              max="18"
            />
            @if (hasError('age', 'required') || hasError('age', 'min') || hasError('age', 'max')) {
              <p class="mt-1 text-sm text-red-500">{{ getErrorMessage('age') }}</p>
            }
          </div>

          <!-- Academic Year -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              Academic Year <span class="text-red-500">*</span>
            </label>
            <select
              formControlName="yearId"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all appearance-none bg-white"
              [class.border-red-500]="hasError('yearId', 'required')"
              [class.border-gray-300]="!hasError('yearId', 'required')"
            >
              <option value="" disabled selected>Select year</option>
              @for (year of academicYears; track year.id) {
                <option [value]="year.id">{{ year.name }} - {{ year.nameAr }}</option>
              }
            </select>
            @if (hasError('yearId', 'required')) {
              <p class="mt-1 text-sm text-red-500">{{ getErrorMessage('yearId') }}</p>
            }
          </div>
        </div>

        <!-- Phone Number (Optional) -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Phone Number <span class="text-gray-400 text-xs">(Optional)</span>
          </label>
          <input
            type="tel"
            formControlName="phoneNumber"
            class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"
            [class.border-red-500]="hasError('phoneNumber', 'pattern')"
            [class.border-gray-300]="!hasError('phoneNumber', 'pattern')"
            placeholder="+1234567890"
          />
          @if (hasError('phoneNumber', 'pattern')) {
            <p class="mt-1 text-sm text-red-500">{{ getErrorMessage('phoneNumber') }}</p>
          }
        </div>

        <!-- Info Box -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <div class="flex items-start gap-3">
            <span class="text-2xl">ℹ️</span>
            <div class="flex-1">
              <h4 class="text-sm font-semibold text-blue-900 mb-1">Parent Linking</h4>
              <p class="text-sm text-blue-800">
                This student will be automatically linked to your parent account.
                You'll be able to monitor their progress from your dashboard.
              </p>
            </div>
          </div>
        </div>

        <!-- Error Message -->
        @if (error()) {
          <div class="bg-red-50 border border-red-200 rounded-lg p-4">
            <div class="flex items-center gap-3">
              <span class="text-2xl">❌</span>
              <p class="text-sm text-red-800">{{ error() }}</p>
            </div>
          </div>
        }

        <!-- Success Message -->
        @if (success()) {
          <div class="bg-green-50 border border-green-200 rounded-lg p-4">
            <div class="flex items-center gap-3">
              <span class="text-2xl">✅</span>
              <p class="text-sm text-green-800">Student registered successfully!</p>
            </div>
          </div>
        }

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 pt-4">
          <button
            type="button"
            (click)="cancel()"
            class="flex-1 px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium">
            Cancel
          </button>
          <button
            type="submit"
            [disabled]="loading() || addStudentForm.invalid"
            class="flex-1 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
            @if (loading()) {
              <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
              <span>Adding Student...</span>
            } @else {
              <span>➕</span>
              <span>Add Student</span>
            }
          </button>
        </div>

        <!-- Form Helper Text -->
        <p class="text-xs text-gray-500 text-center">
          Fields marked with <span class="text-red-500">*</span> are required
        </p>
      </form>
    </div>

    <!-- Additional Info -->
    <div class="mt-6 bg-gray-100 rounded-lg p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-3">What happens next?</h3>
      <ul class="space-y-2 text-sm text-gray-700">
        <li class="flex items-start gap-2">
          <span class="text-green-600 mt-0.5">✓</span>
          <span>Student account will be created and linked to your parent account</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-green-600 mt-0.5">✓</span>
          <span>You can view their progress from your parent dashboard</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-green-600 mt-0.5">✓</span>
          <span>Student can login with their username and password</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-green-600 mt-0.5">✓</span>
          <span>You'll need to purchase a subscription for them to access content</span>
        </li>
      </ul>
    </div>
  </div>
</div>
