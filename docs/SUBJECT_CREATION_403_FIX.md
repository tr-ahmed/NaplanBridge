# ๐ ุฎุทุฃ 403 Forbidden - ุฅูุดุงุก ุงูููุถูุนุงุช (Subjects)

## ๐ ุงููุดููุฉ

```
POST https://naplan2.runasp.net/api/Subjects 403 (Forbidden)
Backend error 403: null
```

ุนูุฏ ูุญุงููุฉ ุฅูุดุงุก ููุถูุน (Subject) ุฌุฏูุฏุ ุชุญุตู ุนูู ุฎุทุฃ **403 Forbidden**.

---

## ๐ ุงูุณุจุจ

ุงูุฎุทุฃ **403 Forbidden** ูุนูู:
- โ ุงููุณุชุฎุฏู ุงูุญุงูู **ููุณ ูุฏูู ุตูุงุญูุฉ** ูุฅูุดุงุก Subjects
- ๐ ูุฏ ุชููู ูุฐู ุงูุนูููุฉ ูุญุตูุฑุฉ ุนูู ูุณุชุฎุฏูู **Admin** ููุท
- โ๏ธ ุฃู ุงููุณุชุฎุฏู ูุง ูููู ุงูุตูุงุญูุฉ `create_subject`

---

## โ ุงูุญููู

### ุงูุญู 1: ุชุณุฌูู ุงูุฏุฎูู ูู Admin
ุฅุฐุง ูุงูุช ุนูููุฉ ุฅูุดุงุก Subjects ูุญุตูุฑุฉ ุนูู Admin:

```
1. ุชุณุฌูู ุงูุฏุฎูู ูู Admin
2. ุซู ูุญุงููุฉ ุฅูุดุงุก Subject ุฌุฏูุฏ
3. ูุฌุจ ุฃู ููุฌุญ ุงูุขู
```

### ุงูุญู 2: ููุญ ุงูุตูุงุญูุงุช ูููุณุชุฎุฏู
ุงุทูุจ ูู **Backend Developer** ุฅุถุงูุฉ ุงูุตูุงุญูุฉ `create_subject` ูุฏูุฑู:

```
Backend:
- ุฃุถู permission: "create_subject" 
- ุงุฑุจุทูุง ุจุฏูุฑ ุงููุณุชุฎุฏู (Teacher ุฃู Custom)
- ุซู ุญุงูู ูุฌุฏุฏุงู
```

### ุงูุญู 3: ุชุนุฏูู Backend Endpoint
ุฅุฐุง ูุงู ุงูููุตูุฏ ุฃู **Teachers** ูููููู ุฅูุดุงุก Subjects:

```
Backend API (Subjects Controller):
[Authorize(Roles = "Teacher,Admin")]  // โ ุฃุถู Teacher
public IActionResult CreateSubject(CreateSubjectDto dto) { ... }
```

---

## ๐ง ุงูุชุญุณููุงุช ุงูููุทุจูุฉ

ุชู ุฅุถุงูุฉ ูุนุงูุฌุฉ ุฎุทุฃ ุฃูุถู ูู:

### 1. `teacher-content-management.service.ts`
```typescript
// โ ุงูุขู ูุธูุฑ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ:
if (error.status === 403) {
  errorMessage = '๐ You do not have permission to create subjects. 
                   Only Admin users can create new subjects.';
}
```

### 2. `subject-creation-modal.component.ts`
```typescript
// โ ูุนุฑุถ ุฑุณุงูุฉ ุงูุฎุทุฃ ูู ุงูุฎุฏูุฉ ุจูุถูุญ
const errorMessage = error?.message || 'Failed to create subject';
this.toastService.showError(errorMessage);
```

---

## ๐ ุฑุณุงุฆู ุงูุฎุทุฃ ุงููุญุณููุฉ

| ุฑูุฒ ุงูุฎุทุฃ | ุงูุฑุณุงูุฉ | ุงูุญู |
|---------|--------|-----|
| **403** | ๐ You do not have permission | ุณุฌูู ุฏุฎูู ูู Admin |
| **400** | โ๏ธ Invalid subject data | ุชุญูู ูู ุงูุจูุงูุงุช |
| **401** | ๐ Your session has expired | ุณุฌูู ุงูุฏุฎูู ูุฌุฏุฏุงู |
| **409** | โ๏ธ A subject with this name exists | ุงุฎุชุฑ ุงุณู ูุฎุชูู |

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### ูุน Admin:
```bash
1. ุณุฌูู ุงูุฏุฎูู ุจุญุณุงุจ Admin
2. ุงูุชุญ ุฅูุดุงุก ููุถูุน ุฌุฏูุฏ
3. ุฃุฏุฎู ุงูุจูุงูุงุช
4. ุงุถุบุท Create
โ ูุฌุจ ุฃู ููุฌุญ
```

### ูุน Teacher:
```bash
1. ุณุฌูู ุงูุฏุฎูู ุจุญุณุงุจ Teacher
2. ุงูุชุญ ุฅูุดุงุก ููุถูุน ุฌุฏูุฏ
3. ุงุถุบุท Create
โ ุณุชุฑู: "You do not have permission"
โ ูุฐุง ูุนูู ุฃูู ุชุญุชุงุฌ ุตูุงุญูุฉ Admin ุฃู ูุฌุจ ุชุนุฏูู Backend
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุชุญูู ูู ุฏูุฑู ุงูุญุงูู:**
   ```javascript
   // ูู Console
   authService.getCurrentUser().role
   ```

2. **ุฅุฐุง ููุช Admin:** ูุฌุจ ุฃู ููุฌุญ ุงูุขู
   - ุชู ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ
   - ูุฌุจ ุฃู ุชุฑู ุฑุณุงูุฉ ูุงุถุญุฉ

3. **ุฅุฐุง ููุช Teacher:** ุชุญุชุงุฌ ุฅูุง:
   - โ ุชุณุฌูู ุฏุฎูู ูู Admin
   - โ ุฃู ุทูุจ Backend ูุฅุถุงูุฉ ุงูุตูุงุญูุฉ

---

## ๐ก ููุงุญุธุงุช

### ูุง ุชู ุฅุตูุงุญู:
โ ุฑุณุงุฆู ุฎุทุฃ ุฃูุซุฑ ูุถูุญุงู
โ ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก
โ ุชูุถูุญ ุงูุณุจุจ ูุงูุญู

### ูู ูุชู ุชุบููุฑู:
- Endpoint API (ูุชุทูุจ ุชุนุฏูู Backend)
- ูุชุทูุจุงุช ุงูุฏูุฑ (ูุฌุจ ุชุญุฏูุฏู ูู Backend)

---

## ๐ฏ ุงูุฎูุงุตุฉ

| ุงูุญุงูุฉ | ุงูุญู |
|--------|-----|
| **Admin ูุฑูุฏ ุงูุฅูุดุงุก** | โ ูุฌุจ ุฃู ูุนูู ุงูุขู ูุน ุฑุณุงุฆู ูุงุถุญุฉ |
| **Teacher ูุฑูุฏ ุงูุฅูุดุงุก** | โ ูุชุทูุจ ุตูุงุญูุงุช ูู Backend |
| **ุฑุณุงุฆู ุงูุฎุทุฃ** | โ ูุญุณููุฉ ููุงุถุญุฉ |

---

## ๐ ุงููุฑุงุฌุน

**ุงููููุงุช ุงููุนุฏููุฉ:**
- `src/app/features/teacher/services/teacher-content-management.service.ts`
- `src/app/features/teacher/content-management/subject-creation-modal/subject-creation-modal.component.ts`

**ุงูุชุญุณููุงุช:**
- ูุนุงูุฌุฉ ุฎุทุฃ 403 ูุน ุฑุณุงูุฉ ูุงุถุญุฉ
- ุฑุณุงุฆู ุฎุทุฃ ูุญุณููุฉ ูุฌููุน ุงูุฃููุงุฏ
- ุชุณุฌูู ุฃูุถู ูู Console
