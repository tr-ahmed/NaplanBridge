# ğŸ“‹ QUICK REFERENCE CARD - Teacher Content Management Backend Issues

**Date:** November 18, 2025  
**Print & Share This** âœ…

---

## THE PROBLEM IN 30 SECONDS

| Issue | Status | Solution Time |
|-------|--------|---|
| **Subjects endpoint returns wrong data** | ğŸ”´ Critical | 30 min |
| **Teacher cannot create subjects (403)** | ğŸ”´ Critical | 15 min |
| **File upload unclear** | ğŸŸ¡ High | 1 hour |
| **Approvals workflow unclear** | ğŸŸ¡ High | 1 hour |

---

## WHAT NEEDS TO BE FIXED

### 1ï¸âƒ£ `/api/TeacherContent/my-subjects`

**Current (WRONG):**
```json
{ "data": [1, 2, 3] }  // Only IDs!
```

**Expected (CORRECT):**
```json
{
  "data": [{
    "subjectId": 1,
    "subjectName": "Math",
    "yearId": 1,
    "yearName": "Grade 10",
    "stats": { "total": 5, "approved": 3, "pending": 1, "rejected": 0, "revisionRequested": 1 }
  }]
}
```

**Fix:** Return full `TeacherSubjectDto` objects with stats

---

### 2ï¸âƒ£ Subject Creation Authorization

**Current (WRONG):**
```
POST /api/Subjects
Response: 403 Forbidden
```

**Expected (CORRECT):**
```
POST /api/Subjects
Response: 201 Created
```

**Fix:** Either:
- Grant teacher `create_subject` permission, OR
- Change `[Authorize(Roles = "Admin")]` to `[Authorize]`

---

### 3ï¸âƒ£ File Upload (`/api/Lessons`)

**Status:** â“ Unclear

**Verify:**
- [ ] Accepts multipart/form-data
- [ ] Stores files correctly
- [ ] Returns file URLs
- [ ] Enforces size limits (10MB images, 500MB videos)

---

## FILES TO MODIFY

### Backend:
```
TeacherContentController.cs
â”œâ”€â”€ GetMySubjects() â† FIX THIS (Priority #1)
â”œâ”€â”€ GetMyContent()
â”œâ”€â”€ GetPendingApprovals()
â””â”€â”€ ApproveContent()

SubjectsController.cs
â””â”€â”€ CreateSubject() â† FIX THIS (Priority #2)

LessonsController.cs
â””â”€â”€ CreateLesson() â† VERIFY THIS (Priority #3)
```

---

## PRIORITY BREAKDOWN

### ğŸ”´ DO TODAY (Critical)
```
1. Fix GetMySubjects() â†’ 30 min
2. Fix Authorization â†’ 15 min
Total: 45 minutes
```

### ğŸŸ¡ DO TOMORROW (High)
```
3. Verify File Upload â†’ 1 hour
4. Verify Approvals â†’ 1 hour
Total: 2 hours
```

---

## TESTING CHECKLIST

After fixing, test:
- [ ] Can fetch teacher's subjects
- [ ] Subjects have complete data
- [ ] Can create new subject
- [ ] Can create lesson with files
- [ ] Can view pending approvals
- [ ] Can approve/reject content

---

## KEY QUESTIONS

1. **Subjects:** What's the actual response format of `GetMySubjects()`?
2. **Permissions:** Can teachers create subjects? If not, how to grant permission?
3. **Files:** Does `POST /api/Lessons` accept multipart/form-data?
4. **Approvals:** Is the approval workflow fully implemented?

---

## FRONTEND STATUS

```
âœ… Angular Components: 10/10 Complete
âœ… Services: 8/8 Written
âœ… Forms: All Validated
âœ… Error Handling: All Done
âœ… Build Status: Success

â³ Waiting for Backend fixes
```

---

## ESTIMATED EFFORT

| Task | Time |
|------|------|
| Fix Subjects | 30 min |
| Fix Auth | 15 min |
| Verify Files | 1 hour |
| Verify Approvals | 1 hour |
| Testing | 30 min |
| **Total** | **~3 hours** |

---

## DETAILED REPORTS LOCATION

```
reports/backend_inquiries/
â”œâ”€â”€ backend_inquiry_teacher_content_management_2025-11-18.md (English)
â””â”€â”€ backend_inquiry_teacher_content_AR_2025-11-18.md (Arabic)

docs/
â”œâ”€â”€ BACKEND_IMPLEMENTATION_CHECKLIST.md (Full Details + Code)
â”œâ”€â”€ BACKEND_TEACHER_CONTENT_ACTION_PLAN_AR.md (Step by Step)
â””â”€â”€ UNIFIED_BACKEND_REQUIREMENTS_SUMMARY.md (All in One)
```

---

## CODE SNIPPETS READY

All code snippets for implementation are in:
`docs/BACKEND_IMPLEMENTATION_CHECKLIST.md`

Just copy-paste and adapt to your codebase!

---

## NEXT STEPS

### For Backend Dev:
1. Read this card
2. Check detailed reports if needed
3. Start with Priority #1
4. Ask questions if unclear
5. Implement fixes
6. Test with Frontend

### For Frontend Dev:
1. Wait for Backend fixes
2. Test with real endpoints
3. Handle any response differences
4. Deploy together

---

## SLACK MESSAGE TEMPLATE

```
ğŸš¨ Backend fixes needed for Teacher Content Management:

1. âŒ /api/TeacherContent/my-subjects returns only IDs (need full objects)
2. âŒ Teachers can't create subjects (403 error)
3. â“ File upload handling unclear
4. â“ Approval workflow unclear

Est. effort: 2-3 hours
Priority: HIGH

Details: See reports/backend_inquiries/ folder

Who can help? ğŸ™‹
```

---

**Print this card and share with your Backend team!** ğŸ“„

---

*Generated by: GitHub Copilot*  
*Date: November 18, 2025*

